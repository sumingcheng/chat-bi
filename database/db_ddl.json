{
  "timestamp": "2025-02-27T16:09:06.079073",
  "database": "query_db",
  "tables": {
    "cart_item": "CREATE TABLE `cart_item` (\n  `cart_item_id` int NOT NULL AUTO_INCREMENT COMMENT '购物车项ID',\n  `cart_id` int DEFAULT NULL COMMENT '购物车ID',\n  `product_id` int DEFAULT NULL COMMENT '商品ID',\n  `quantity` int NOT NULL COMMENT '数量',\n  `created_at` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',\n  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',\n  PRIMARY KEY (`cart_item_id`),\n  KEY `cart_id` (`cart_id`),\n  KEY `product_id` (`product_id`),\n  CONSTRAINT `cart_item_ibfk_1` FOREIGN KEY (`cart_id`) REFERENCES `shopping_cart` (`cart_id`),\n  CONSTRAINT `cart_item_ibfk_2` FOREIGN KEY (`product_id`) REFERENCES `product` (`product_id`)\n) ENGINE=InnoDB AUTO_INCREMENT=9 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='购物车项表'",
    "category": "CREATE TABLE `category` (\n  `category_id` int NOT NULL AUTO_INCREMENT COMMENT '类别ID',\n  `category_name` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '类别名称',\n  `category_description` text COLLATE utf8mb4_unicode_ci COMMENT '类别描述',\n  PRIMARY KEY (`category_id`)\n) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='产品类别表'",
    "coupon": "CREATE TABLE `coupon` (\n  `coupon_id` int NOT NULL AUTO_INCREMENT COMMENT '优惠券ID',\n  `code` varchar(50) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '优惠券码',\n  `type` enum('percentage','fixed') COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '优惠类型：百分比/固定金额',\n  `value` decimal(10,2) DEFAULT NULL COMMENT '优惠值',\n  `min_purchase` decimal(10,2) DEFAULT NULL COMMENT '最低消费金额',\n  `start_date` datetime DEFAULT NULL COMMENT '生效时间',\n  `end_date` datetime DEFAULT NULL COMMENT '过期时间',\n  `created_at` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',\n  PRIMARY KEY (`coupon_id`),\n  UNIQUE KEY `code` (`code`)\n) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='优惠券表'",
    "customer": "CREATE TABLE `customer` (\n  `customer_id` int NOT NULL AUTO_INCREMENT COMMENT '客户ID',\n  `username` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '用户名',\n  `password_hash` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '密码哈希值',\n  `email` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '电子邮箱',\n  `first_name` varchar(50) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '名',\n  `last_name` varchar(50) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '姓',\n  `date_of_birth` date DEFAULT NULL COMMENT '出生日期',\n  `registration_date` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '注册日期',\n  `last_login` datetime DEFAULT NULL COMMENT '最后登录时间',\n  `account_status` enum('active','inactive','banned') COLLATE utf8mb4_unicode_ci DEFAULT 'active' COMMENT '账号状态',\n  PRIMARY KEY (`customer_id`),\n  UNIQUE KEY `username` (`username`),\n  UNIQUE KEY `email` (`email`)\n) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='客户信息表'",
    "customer_coupon": "CREATE TABLE `customer_coupon` (\n  `customer_coupon_id` int NOT NULL AUTO_INCREMENT COMMENT '用户优惠券ID',\n  `customer_id` int DEFAULT NULL COMMENT '客户ID',\n  `coupon_id` int DEFAULT NULL COMMENT '优惠券ID',\n  `status` enum('unused','used','expired') COLLATE utf8mb4_unicode_ci DEFAULT 'unused' COMMENT '使用状态',\n  `used_time` datetime DEFAULT NULL COMMENT '使用时间',\n  `created_at` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',\n  PRIMARY KEY (`customer_coupon_id`),\n  KEY `customer_id` (`customer_id`),\n  KEY `coupon_id` (`coupon_id`),\n  CONSTRAINT `customer_coupon_ibfk_1` FOREIGN KEY (`customer_id`) REFERENCES `customer` (`customer_id`),\n  CONSTRAINT `customer_coupon_ibfk_2` FOREIGN KEY (`coupon_id`) REFERENCES `coupon` (`coupon_id`)\n) ENGINE=InnoDB AUTO_INCREMENT=9 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='用户优惠券表'",
    "order_item": "CREATE TABLE `order_item` (\n  `order_item_id` int NOT NULL AUTO_INCREMENT COMMENT '订单项ID',\n  `order_id` int DEFAULT NULL COMMENT '订单ID',\n  `product_id` int DEFAULT NULL COMMENT '产品ID',\n  `quantity` int NOT NULL COMMENT '购买数量',\n  `unit_price` decimal(10,2) NOT NULL COMMENT '单价',\n  PRIMARY KEY (`order_item_id`),\n  KEY `product_id` (`product_id`),\n  KEY `idx_order_product` (`order_id`,`product_id`),\n  CONSTRAINT `order_item_ibfk_1` FOREIGN KEY (`order_id`) REFERENCES `sales_order` (`order_id`),\n  CONSTRAINT `order_item_ibfk_2` FOREIGN KEY (`product_id`) REFERENCES `product` (`product_id`)\n) ENGINE=InnoDB AUTO_INCREMENT=21 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='订单项表'",
    "payment": "CREATE TABLE `payment` (\n  `payment_id` int NOT NULL AUTO_INCREMENT COMMENT '支付ID',\n  `order_id` int DEFAULT NULL COMMENT '订单ID',\n  `payment_amount` decimal(10,2) NOT NULL COMMENT '支付金额',\n  `payment_method` enum('alipay','wechat','credit_card','other') COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '支付方式',\n  `payment_status` enum('pending','success','failed','refunded') COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '支付状态',\n  `transaction_id` varchar(100) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '第三方支付交易号',\n  `created_at` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',\n  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',\n  PRIMARY KEY (`payment_id`),\n  KEY `order_id` (`order_id`),\n  CONSTRAINT `payment_ibfk_1` FOREIGN KEY (`order_id`) REFERENCES `sales_order` (`order_id`)\n) ENGINE=InnoDB AUTO_INCREMENT=11 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='支付记录表'",
    "product": "CREATE TABLE `product` (\n  `product_id` int NOT NULL AUTO_INCREMENT COMMENT '产品ID',\n  `product_name` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '产品名称',\n  `category_id` int DEFAULT NULL COMMENT '类别ID',\n  `product_description` text COLLATE utf8mb4_unicode_ci COMMENT '产品描述',\n  `price` decimal(10,2) NOT NULL COMMENT '价格',\n  `stock_quantity` int DEFAULT '0' COMMENT '库存数量',\n  `created_at` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',\n  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',\n  PRIMARY KEY (`product_id`),\n  KEY `category_id` (`category_id`),\n  KEY `idx_product_price` (`price`),\n  CONSTRAINT `product_ibfk_1` FOREIGN KEY (`category_id`) REFERENCES `category` (`category_id`)\n) ENGINE=InnoDB AUTO_INCREMENT=21 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='产品信息表'",
    "product_review": "CREATE TABLE `product_review` (\n  `review_id` int NOT NULL AUTO_INCREMENT COMMENT '评价ID',\n  `product_id` int DEFAULT NULL COMMENT '商品ID',\n  `customer_id` int DEFAULT NULL COMMENT '客户ID',\n  `order_id` int DEFAULT NULL COMMENT '订单ID',\n  `rating` int NOT NULL COMMENT '评分(1-5星)',\n  `content` text COLLATE utf8mb4_unicode_ci COMMENT '评价内容',\n  `created_at` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',\n  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',\n  PRIMARY KEY (`review_id`),\n  KEY `product_id` (`product_id`),\n  KEY `customer_id` (`customer_id`),\n  KEY `order_id` (`order_id`),\n  CONSTRAINT `product_review_ibfk_1` FOREIGN KEY (`product_id`) REFERENCES `product` (`product_id`),\n  CONSTRAINT `product_review_ibfk_2` FOREIGN KEY (`customer_id`) REFERENCES `customer` (`customer_id`),\n  CONSTRAINT `product_review_ibfk_3` FOREIGN KEY (`order_id`) REFERENCES `sales_order` (`order_id`),\n  CONSTRAINT `chk_rating` CHECK (((`rating` >= 1) and (`rating` <= 5)))\n) ENGINE=InnoDB AUTO_INCREMENT=11 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='商品评价表'",
    "sales": "CREATE TABLE `sales` (\n  `sale_id` int NOT NULL AUTO_INCREMENT COMMENT '销售ID',\n  `product_id` int DEFAULT NULL COMMENT '产品ID',\n  `customer_id` int DEFAULT NULL COMMENT '客户ID',\n  `quantity` int NOT NULL COMMENT '销售数量',\n  `total_amount` decimal(10,2) NOT NULL COMMENT '销售总额',\n  `sale_date` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '销售日期',\n  PRIMARY KEY (`sale_id`),\n  KEY `product_id` (`product_id`),\n  KEY `customer_id` (`customer_id`),\n  KEY `idx_sale_date` (`sale_date`),\n  CONSTRAINT `sales_ibfk_1` FOREIGN KEY (`product_id`) REFERENCES `product` (`product_id`),\n  CONSTRAINT `sales_ibfk_2` FOREIGN KEY (`customer_id`) REFERENCES `customer` (`customer_id`)\n) ENGINE=InnoDB AUTO_INCREMENT=21 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='销售记录表'",
    "sales_order": "CREATE TABLE `sales_order` (\n  `order_id` int NOT NULL AUTO_INCREMENT COMMENT '订单ID',\n  `customer_id` int DEFAULT NULL COMMENT '客户ID',\n  `order_date` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '订单日期',\n  `total_amount` decimal(10,2) NOT NULL COMMENT '总金额',\n  `order_status` enum('pending','processing','shipped','delivered','cancelled') COLLATE utf8mb4_unicode_ci DEFAULT 'pending' COMMENT '订单状态',\n  `shipping_address` varchar(255) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '收货地址',\n  `billing_address` varchar(255) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '账单地址',\n  PRIMARY KEY (`order_id`),\n  KEY `customer_id` (`customer_id`),\n  CONSTRAINT `sales_order_ibfk_1` FOREIGN KEY (`customer_id`) REFERENCES `customer` (`customer_id`)\n) ENGINE=InnoDB AUTO_INCREMENT=11 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='销售订单表'",
    "shipping_address": "CREATE TABLE `shipping_address` (\n  `address_id` int NOT NULL AUTO_INCREMENT COMMENT '地址ID',\n  `customer_id` int DEFAULT NULL COMMENT '客户ID',\n  `receiver` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '收货人',\n  `phone` varchar(20) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '联系电话',\n  `province` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '省份',\n  `city` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '城市',\n  `district` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '区县',\n  `detail` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '详细地址',\n  `is_default` tinyint(1) DEFAULT '0' COMMENT '是否默认地址',\n  `created_at` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',\n  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',\n  PRIMARY KEY (`address_id`),\n  KEY `customer_id` (`customer_id`),\n  CONSTRAINT `shipping_address_ibfk_1` FOREIGN KEY (`customer_id`) REFERENCES `customer` (`customer_id`)\n) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='收货地址表'",
    "shopping_cart": "CREATE TABLE `shopping_cart` (\n  `cart_id` int NOT NULL AUTO_INCREMENT COMMENT '购物车ID',\n  `customer_id` int DEFAULT NULL COMMENT '客户ID',\n  `created_at` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',\n  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',\n  PRIMARY KEY (`cart_id`),\n  KEY `customer_id` (`customer_id`),\n  CONSTRAINT `shopping_cart_ibfk_1` FOREIGN KEY (`customer_id`) REFERENCES `customer` (`customer_id`)\n) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='购物车表'"
  }
}